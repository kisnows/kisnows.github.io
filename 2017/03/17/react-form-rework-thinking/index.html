<!DOCTYPE html><html class="theme-next gemini" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="ALjLGbNNO4kwWmxb3-Af6cyUejHJjNhwNQ"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Fira Code:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.png?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.png?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.png?v=5.1.3"><link rel="mask-icon" href="/favicon.png?v=5.1.3" color="#222"><meta name="keywords" content="React,"><link rel="alternate" href="/atom.xml" title="æŠ¹æ¡¥çš„åšå®¢" type="application/atom+xml"><meta name="description" content="æœ€è¿‘å¯¹å›¢é˜Ÿå†…éƒ¨ React ç»„ä»¶åº“ï¼ˆne-rcï¼‰ä¸­çš„ Form ç»„ä»¶è¿›è¡Œäº†é‡æ„ï¼Œè®°å½•ä¸€ä¸‹æ€è€ƒçš„è¿‡ç¨‹ã€‚ä¸€äº›å‰ç½®å®šä¹‰ï¼šåè¯å®šä¹‰è¡¨å•Form ç»„ä»¶å­è¡¨å•åµŒå¥—åœ¨ Form ä¸‹é¢çš„ç±»ä¼¼ Input, Select è¿™æ ·çš„å­ç»„ä»¶é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„å¯¹ Form ç»„ä»¶çš„éœ€æ±‚æ˜¯ä»€ä¹ˆã€‚è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€æ ¡éªŒæ‰€æœ‰å¿…å¡«è¡¨å•æ˜¯å¦å¡«å†™å®Œæˆå¯¹å¤–è§¦å‘å…·ä½“è¡¨å•å˜åŒ–çš„æ–¹æ³• formFieldChangeæš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶"><meta name="keywords" content="React"><meta property="og:type" content="article"><meta property="og:title" content="ä¸€ä¸ª React Form ç»„ä»¶çš„é‡æ„æ€è·¯"><meta property="og:url" content="https://blog.kisnows.com/2017/03/17/react-form-rework-thinking/index.html"><meta property="og:site_name" content="æŠ¹æ¡¥çš„åšå®¢"><meta property="og:description" content="æœ€è¿‘å¯¹å›¢é˜Ÿå†…éƒ¨ React ç»„ä»¶åº“ï¼ˆne-rcï¼‰ä¸­çš„ Form ç»„ä»¶è¿›è¡Œäº†é‡æ„ï¼Œè®°å½•ä¸€ä¸‹æ€è€ƒçš„è¿‡ç¨‹ã€‚ä¸€äº›å‰ç½®å®šä¹‰ï¼šåè¯å®šä¹‰è¡¨å•Form ç»„ä»¶å­è¡¨å•åµŒå¥—åœ¨ Form ä¸‹é¢çš„ç±»ä¼¼ Input, Select è¿™æ ·çš„å­ç»„ä»¶é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„å¯¹ Form ç»„ä»¶çš„éœ€æ±‚æ˜¯ä»€ä¹ˆã€‚è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€æ ¡éªŒæ‰€æœ‰å¿…å¡«è¡¨å•æ˜¯å¦å¡«å†™å®Œæˆå¯¹å¤–è§¦å‘å…·ä½“è¡¨å•å˜åŒ–çš„æ–¹æ³• formFieldChangeæš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2017-03-17T14:24:07.512Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="ä¸€ä¸ª React Form ç»„ä»¶çš„é‡æ„æ€è·¯"><meta name="twitter:description" content="æœ€è¿‘å¯¹å›¢é˜Ÿå†…éƒ¨ React ç»„ä»¶åº“ï¼ˆne-rcï¼‰ä¸­çš„ Form ç»„ä»¶è¿›è¡Œäº†é‡æ„ï¼Œè®°å½•ä¸€ä¸‹æ€è€ƒçš„è¿‡ç¨‹ã€‚ä¸€äº›å‰ç½®å®šä¹‰ï¼šåè¯å®šä¹‰è¡¨å•Form ç»„ä»¶å­è¡¨å•åµŒå¥—åœ¨ Form ä¸‹é¢çš„ç±»ä¼¼ Input, Select è¿™æ ·çš„å­ç»„ä»¶é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„å¯¹ Form ç»„ä»¶çš„éœ€æ±‚æ˜¯ä»€ä¹ˆã€‚è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€æ ¡éªŒæ‰€æœ‰å¿…å¡«è¡¨å•æ˜¯å¦å¡«å†™å®Œæˆå¯¹å¤–è§¦å‘å…·ä½“è¡¨å•å˜åŒ–çš„æ–¹æ³• formFieldChangeæš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.3",sidebar:{position:"left",display:"post",offset:12,b2t:!0,scrollpercent:!0,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!1,async:!0,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"åšä¸»"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://blog.kisnows.com/2017/03/17/react-form-rework-thinking/"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-5680248525294797",enable_page_level_ads:!0})</script><title>ä¸€ä¸ª React Form ç»„ä»¶çš„é‡æ„æ€è·¯ | æŠ¹æ¡¥çš„åšå®¢</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58453734-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-58453734-1")</script><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?be602d9678e35053ae404d6230640d41";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">æŠ¹æ¡¥çš„åšå®¢</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Seize the day.</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>é¦–é¡µ</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>å½’æ¡£</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>åˆ†ç±»</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>æ ‡ç­¾</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>å…³äº</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://blog.kisnows.com/2017/03/17/react-form-rework-thinking/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŠ¹æ¡¥"><meta itemprop="description" content=""><meta itemprop="image" content="/imgs/avatar.jpg"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æŠ¹æ¡¥çš„åšå®¢"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">ä¸€ä¸ª React Form ç»„ä»¶çš„é‡æ„æ€è·¯</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-03-17T21:31:31+08:00">2017-03-17 </time><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">æ›´æ–°äº:</span> <time title="æ›´æ–°äº" itemprop="dateModified" datetime="2017-03-17T22:24:07+08:00">2017-03-17 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/æŠ€æœ¯/" itemprop="url" rel="index"><span itemprop="name">æŠ€æœ¯</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2017/03/17/react-form-rework-thinking/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/03/17/react-form-rework-thinking/" itemprop="commentCount"></span> </a></span><span id="/2017/03/17/react-form-rework-thinking/" class="leancloud_visitors" data-flag-title="ä¸€ä¸ª React Form ç»„ä»¶çš„é‡æ„æ€è·¯"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°:</span> <span class="leancloud-visitors-count"></span></span></div></header><div class="post-body han-init-context" itemprop="articleBody"><p>æœ€è¿‘å¯¹å›¢é˜Ÿå†…éƒ¨ React ç»„ä»¶åº“ï¼ˆ<a href="https://github.com/NE-LOAN-FED/NE-Component" target="_blank" rel="noopener"><strong>ne-rc</strong></a>ï¼‰ä¸­çš„ Form ç»„ä»¶è¿›è¡Œäº†é‡æ„ï¼Œè®°å½•ä¸€ä¸‹æ€è€ƒçš„è¿‡ç¨‹ã€‚</p><p>ä¸€äº›å‰ç½®å®šä¹‰ï¼š</p><table><thead><tr><th>åè¯</th><th>å®šä¹‰</th></tr></thead><tbody><tr><td>è¡¨å•</td><td>Form ç»„ä»¶</td></tr><tr><td>å­è¡¨å•</td><td>åµŒå¥—åœ¨ Form ä¸‹é¢çš„ç±»ä¼¼ Input, Select è¿™æ ·çš„å­ç»„ä»¶</td></tr></tbody></table><p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„å¯¹ Form ç»„ä»¶çš„éœ€æ±‚æ˜¯ä»€ä¹ˆã€‚</p><ol><li>è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€<ul><li>æ ¡éªŒæ‰€æœ‰å¿…å¡«è¡¨å•æ˜¯å¦å¡«å†™å®Œæˆ</li><li>å¯¹å¤–è§¦å‘å…·ä½“è¡¨å•å˜åŒ–çš„æ–¹æ³• <code>formFieldChange</code></li></ul></li><li>æš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶æ€çš„æ–¹æ³•<ul><li>æä¾›æ•´ä¸ªè¡¨å•æœ€æ–°çŠ¶æ€çš„æ–¹æ³• $Form.data</li></ul></li><li>æäº¤æ–¹æ³•<ul><li>æ ¡éªŒè¡¨å•æ˜¯å¦é€šè¿‡æ ¡éªŒ</li><li>å¯¹å¤–è§¦å‘ <code>formSubmit</code> æ–¹æ³•</li></ul></li></ol><p>æ¥ç€æˆ‘ä»¬ä»é‡æ„å‰å’Œé‡æ„åï¼Œçœ‹å¦‚ä½•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h1 id="Before"><a href="#Before" class="headerlink" title="Before"></a><strong>Before</strong></h1><h2 id="è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€"><a href="#è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€" class="headerlink" title="è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€"></a>è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€</h2><h3 id="å¦‚ä½•è·å–å˜åŠ¨çš„å­è¡¨å•"><a href="#å¦‚ä½•è·å–å˜åŠ¨çš„å­è¡¨å•" class="headerlink" title="å¦‚ä½•è·å–å˜åŠ¨çš„å­è¡¨å•"></a>å¦‚ä½•è·å–å˜åŠ¨çš„å­è¡¨å•</h3><p>React çˆ¶å­é€šä¿¡éœ€è¦é€šè¿‡ prop ä¼ é€’æ–¹æ³•ï¼Œå¯¹äº Form ä¸‹é¢çš„ç±»ä¼¼ä¸ Input ä¹‹ç±»çš„å­è¡¨å•çš„å˜åŒ–æƒ³è¦é€šçŸ¥åˆ°çˆ¶çº§ï¼Œå¦‚æœä¸å€ŸåŠ©ç¬¬ä¸‰æ–¹çš„äº‹ä»¶ä¼ é€’æ–¹æ³•ï¼Œé‚£ä¹ˆå°±åªèƒ½é€šè¿‡ç”±çˆ¶çº§é€šè¿‡ props å‘ Input ä¼ é€’ <code>formFieldChange</code>ï¼ˆå‡è®¾å°±å«è¿™ä¸ªåå­—ï¼‰æ–¹æ³•ï¼Œç„¶åå½“å­ç»„ä»¶å˜åŒ–æ—¶å»è°ƒç”¨ <code>formFieldChange</code> æ¥å®ç°ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä»€ä¹ˆæ—¶å€™å»ä¼ é€’è¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿ</p><p>ä¸èƒ½åœ¨å…·ä½“é¡µé¢é‡Œé¢ä½¿ç”¨çš„æ—¶å€™å†å»æ¯æ¡è¡¨å•é‡Œé¢æ³¨å†Œè¿™ä¸ªæ–¹æ³•ï¼Œé‚£æ¯ä¸ªç”¨åˆ°è¡¨å•ç»„ä»¶çš„æ—¶å€™å°±éƒ½éœ€è¦ç»™å­è¡¨å•è¿›è¡Œè¿™æ ·çš„äº‹ä»¶ç»‘å®šï¼Œè¿™æ ·å¤ªç´¯äº†ã€‚</p><p>æ‰€ä»¥ä¸€å¼€å§‹ï¼Œæˆ‘é€‰æ‹©é€šè¿‡ç›´æ¥é€’å½’çš„éå† Form ä¸‹é¢çš„ childrenï¼Œåªè¦å‘ç°è¿™ä¸ª children æ˜¯æˆ‘æƒ³è¦çš„è¡¨å•ç±»å‹ï¼Œé‚£ä¹ˆå°±é‡æ–°å…‹éš†ä¸€ä¸ªå¸¦æœ‰ <code>formFieldChange</code> çš„ç»„ä»¶æ¥æ›¿æ¢æ‰åŸæ¥çš„ç»„ä»¶ã€‚<br><a id="more"></a><br></p><figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * è·å– form ä¸‹é¢æ¯ä¸€ä¸ªè¡¨å•å¯¹è±¡ï¼Œæ³¨å…¥å±æ€§ï¼Œå¹¶æ”¶é›†èµ·æ¥</span></span><br><span class="line"><span class="comment">  * @param children</span></span><br><span class="line"><span class="comment">  * @returns {*}</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getForms</span>(<span class="params">children</span>) </span>{</span><br><span class="line">  <span class="keyword">return</span> React.Children.map(children, (el, i) => {</span><br><span class="line">    <span class="keyword">if</span> (!el) {</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">switch</span> (el.type) {</span><br><span class="line">      <span class="keyword">case</span> Input:</span><br><span class="line">        Forms.push(el)</span><br><span class="line">        <span class="keyword">return</span> React.cloneElement(</span><br><span class="line">          el,</span><br><span class="line">          {</span><br><span class="line">            key: i,</span><br><span class="line">            formFieldChange,</span><br><span class="line">            emptyInput</span><br><span class="line">          }</span><br><span class="line">        )</span><br><span class="line">      <span class="keyword">case</span> Select:</span><br><span class="line">        Forms.push(el)</span><br><span class="line">        <span class="keyword">return</span> React.cloneElement(</span><br><span class="line">          el,</span><br><span class="line">          {</span><br><span class="line">            key: i,</span><br><span class="line">            formFieldChange</span><br><span class="line">          }</span><br><span class="line">        )</span><br><span class="line">      <span class="keyword">case</span> CheckBox:</span><br><span class="line">        Forms.push(el)</span><br><span class="line">        <span class="keyword">return</span> React.cloneElement(</span><br><span class="line">          el,</span><br><span class="line">          {</span><br><span class="line">            key: i,</span><br><span class="line">            formFieldChange</span><br><span class="line">          }</span><br><span class="line">        )</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">if</span> (el.props && el.props.children <span class="keyword">instanceof</span> <span class="built_in">Array</span>) {</span><br><span class="line">          <span class="keyword">const</span> children = getForms(el.props.children)</span><br><span class="line">          <span class="keyword">return</span> React.cloneElement(</span><br><span class="line">            el,</span><br><span class="line">            {</span><br><span class="line">              key: i,</span><br><span class="line">              children</span><br><span class="line">            }</span><br><span class="line">          )</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">          <span class="keyword">return</span> el</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">  })</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>è¿™æ ·ï¼Œæ‰€æœ‰çš„ç‰¹å®šå­ç»„ä»¶å°±éƒ½å¯ä»¥æ‹¿åˆ°è¢«æ³¨å†Œçš„æ–¹æ³•ã€‚ä»¥ Input ä¸ºä¾‹ï¼Œåœ¨ Input çš„ <code>onChange</code> æ–¹æ³•é‡Œé¢å»è°ƒç”¨ä»çˆ¶çº§ props ä¼ å…¥çš„ <code>formFieldChange</code> å°±å¯ä»¥é€šçŸ¥åˆ° Form ç»„ä»¶äº†ã€‚</p><h3 id="æ”¶é›†å˜åŠ¨è¡¨å•çš„æ•°æ®ã€‚"><a href="#æ”¶é›†å˜åŠ¨è¡¨å•çš„æ•°æ®ã€‚" class="headerlink" title="æ”¶é›†å˜åŠ¨è¡¨å•çš„æ•°æ®ã€‚"></a>æ”¶é›†å˜åŠ¨è¡¨å•çš„æ•°æ®ã€‚</h3><p>å‰ä¸€æ­¥å®Œæˆåï¼Œè¿™ä¸€æ­¥å°±æ¯”è¾ƒç®€å•äº†ï¼ŒInput åœ¨è°ƒç”¨ <code>formFieldChange</code> çš„æ—¶å€™æŠŠæƒ³è¦ä¼ é€’çš„æ•°æ®ä½œä¸ºå‚æ•°ä¼ è¿›å»ï¼Œåœ¨ Form é‡Œé¢å»å¯¹è¿™ä¸ªå‚æ•°åšå¤„ç†ï¼Œå°±å¯ä»¥æ‹¿åˆ°å½“å‰å˜åŠ¨çš„è¡¨å•çŠ¶æ€æ•°æ®äº†ã€‚</p><h3 id="æ ¡éªŒè¡¨å•æ˜¯å¦å¡«å†™å®Œæˆ"><a href="#æ ¡éªŒè¡¨å•æ˜¯å¦å¡«å†™å®Œæˆ" class="headerlink" title="æ ¡éªŒè¡¨å•æ˜¯å¦å¡«å†™å®Œæˆ"></a>æ ¡éªŒè¡¨å•æ˜¯å¦å¡«å†™å®Œæˆ</h3><p>å‰é¢æˆ‘ä»¬æ”¶é›†äº†æ¯ä¸€æ¡å˜åŠ¨è¡¨å•çš„æ•°æ®ã€‚ä½†æ˜¯è¦åˆ¤æ–­å½“å‰ Form ä¸‹é¢çš„è¡¨å•æ˜¯å¦å¡«å†™å®Œæˆï¼Œé‚£ä¹ˆé¦–å…ˆéœ€è¦çŸ¥é“æˆ‘ä»¬æœ‰å¤šå°‘ä¸ªéœ€è¦å¡«å†™çš„è¡¨å•ï¼Œç„¶ååœ¨ <code>formFieldChange</code> çš„æ—¶å€™è¿›è¡Œåˆ¤æ–­å°±å¯ä»¥äº†ã€‚å¦‚ä½•æ¥æå‰çŸ¥é“æˆ‘ä»¬æœ‰å¤šå°‘éœ€è¦å¡«å†™çš„ Field å‘¢ï¼Œä¹‹å‰æˆ‘é€‰æ‹©çš„æ˜¯é€šè¿‡åœ¨ä½¿ç”¨ Form çš„æ—¶å€™å…ˆåˆå§‹åŒ–ä¸€ä¸ªåŒ…å«æ‰€æœ‰è¡¨å•åˆå§‹åŒ–çŠ¶æ€çš„æ•°æ®ã€‚<br></p><figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Form</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>{</span><br><span class="line">  <span class="keyword">constructor</span>(props) {</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">    <span class="keyword">this</span>.Forms = []</span><br><span class="line">    <span class="keyword">this</span>.formState = <span class="built_in">Object</span>.assign({}, {</span><br><span class="line">      isComplete: <span class="literal">false</span>,</span><br><span class="line">      isValidate: <span class="literal">false</span>,</span><br><span class="line">      errorMsg: <span class="string">''</span>,</span><br><span class="line">      data: {}</span><br><span class="line">    }, <span class="keyword">this</span>.props.formState)</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> propTypes = {</span><br><span class="line">    onChange: PropTypes.func,</span><br><span class="line">    onSubmit: PropTypes.func,</span><br><span class="line">    formState: PropTypes.object</span><br><span class="line">  }</span><br><span class="line">Â <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„å¯¹è±¡ä¼ é€’ç»™ Form</span></span><br><span class="line">formState: {</span><br><span class="line">  data: {</span><br><span class="line">    realName: {},</span><br><span class="line">    cityId: {},</span><br><span class="line">    email: {},</span><br><span class="line">    relativeName: {},</span><br><span class="line">    relativePhone: {},</span><br><span class="line">    companyName: {}</span><br><span class="line">  }</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></figure><p></p><p>è¿™æ ·å°±å¾ˆç²—æš´çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯è¿™ä¸­é—´å­˜åœ¨å¾ˆå¤šé—®é¢˜ã€‚</p><p>å› ä¸ºé™å®šäº†ç‰¹å®šçš„ç»„ä»¶ç±»å‹ï¼ˆInputï¼ŒSelectï¼ŒCheckBoxï¼‰ï¼Œå¯¼è‡´ä¸åˆ©äºæ‰©å±•ï¼Œå¦‚æœåœ¨å¼€å‘è¿‡ç¨‹é‡åˆ°å…¶ä»–ç±»å‹çš„æ¯”å¦‚è‡ªå®šä¹‰çš„å­è¡¨å•ï¼Œé‚£ä¹ˆ Form å°±æ²¡æ³•å¯¹è¿™ä¸ªè‡ªå®šä¹‰å­è¡¨å•è¿›è¡Œæ•°æ®æ”¶é›†ï¼Œè§£å†³èµ·æ¥æ¯”è¾ƒéº»çƒ¦ã€‚</p><p>æ‰€ä»¥å°±åœ¨è€ƒè™‘å¦ä¸€ä¸ªç§å®ç°æ–¹å¼ï¼Œ Form åªå»æ”¶é›†ä¸€ä¸ªç‰¹å®šæ¡ä»¶ä¸‹çš„ç»„ä»¶ï¼Œåªè¦è¿™ä¸ªç»„ä»¶æ»¡è¶³äº†è¿™ä¸ªæ¡ä»¶ï¼Œå¹¶å®ç°äº†å¯¹åº”çš„æ¥å£ï¼Œé‚£ä¹ˆ Form å°±éƒ½å¯ä»¥å»æ”¶é›†å¤„ç†ã€‚è¿™æ ·ä¹Ÿå°±å¤§å¤§æŒºé«˜äº†é€‚ç”¨æ€§ã€‚</p><h2 id="æš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶æ€çš„æ–¹æ³•"><a href="#æš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶æ€çš„æ–¹æ³•" class="headerlink" title="æš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶æ€çš„æ–¹æ³•"></a>æš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶æ€çš„æ–¹æ³•</h2><p>é€šè¿‡åœ¨å¤–ç›‘å¬æ¯æ¬¡ Form è§¦å‘çš„ <code>onChange</code> äº‹ä»¶æ¥è·å–æ•´ä¸ª Form çš„çŠ¶æ€ã€‚</p><h2 id="æäº¤æ–¹æ³•"><a href="#æäº¤æ–¹æ³•" class="headerlink" title="æäº¤æ–¹æ³•"></a>æäº¤æ–¹æ³•</h2><h3 id="æ£€éªŒè¡¨å•æ˜¯å¦é€šè¿‡æ ¡éªŒ"><a href="#æ£€éªŒè¡¨å•æ˜¯å¦é€šè¿‡æ ¡éªŒ" class="headerlink" title="æ£€éªŒè¡¨å•æ˜¯å¦é€šè¿‡æ ¡éªŒ"></a>æ£€éªŒè¡¨å•æ˜¯å¦é€šè¿‡æ ¡éªŒ</h3><p>å·²ç»æœ‰äº†æ•´ä¸ª Form çš„æ•°æ®å¯¹è±¡ï¼Œåšæ ¡éªŒå¹¶ä¸æ˜¯ä»€ä¹ˆå›°éš¾ã€‚é€šè¿‡æ ¡éªŒçš„æ—¶å€™è°ƒç”¨ <code>formSubmit</code> æ–¹æ³•ï¼Œæ²¡æœ‰é€šè¿‡æ ¡éªŒçš„æ—¶å€™å¯¹å¤–æŠŠé”™è¯¯ä¿¡æ¯æ·»åŠ åˆ° Form çš„ state ä¸Šå»ã€‚</p><h3 id="å¯¹å¤–è§¦å‘-formSubmit-æ–¹æ³•"><a href="#å¯¹å¤–è§¦å‘-formSubmit-æ–¹æ³•" class="headerlink" title="å¯¹å¤–è§¦å‘ formSubmit æ–¹æ³•"></a>å¯¹å¤–è§¦å‘ formSubmit æ–¹æ³•</h3><p>å½“è¡¨å•é€šè¿‡æ ¡éªŒçš„æ—¶å€™ï¼Œå¯¹å¤–è§¦å‘ <code>formSubmit</code> æ–¹æ³•ï¼ŒæŠŠè¦æäº¤çš„æ•°æ®ä½œä¸º <code>formSubmit</code> çš„å‚æ•°ä¼ é€’ç»™å¤–é¢ã€‚</p><h1 id="After"><a href="#After" class="headerlink" title="After"></a><strong>After</strong></h1><p>å‰é¢æ˜¯ä¹‹å‰å†™çš„ Form ç»„ä»¶çš„ä¸€äº›æ€è·¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ä¹ŸåŸºæœ¬èƒ½æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ã€‚</p><p>ä½†æ˜¯æ•´ä¸ª Form çš„å¯æ‹“å±•æ€§æ¯”è¾ƒå·®ï¼Œæ— æ³•å¾ˆå¥½çš„æ¥å…¥å…¶ä»–è‡ªå®šä¹‰çš„ç»„ä»¶ã€‚æ‰€ä»¥èŒç”Ÿäº†é‡å†™çš„æƒ³æ³•ã€‚</p><p>å¯¹äºé‡å†™çš„è¿™ä¸ª Formï¼Œæˆ‘çš„æƒ³æ³•æ˜¯ï¼šé¦–å…ˆä¸€å®šè¦æ–¹ä¾¿ä½¿ç”¨ï¼Œä¸éœ€è¦ä¸€å¤§å †çš„èµ·å§‹å·¥ä½œï¼›å…¶æ¬¡å°±æ˜¯å¯æ‹“å±•æ€§è¦å¼ºï¼Œé™¤äº†è‡ªå·±å·²ç»æä¾›çš„å†…åœ¨ Inputï¼ŒSelect ç­‰èƒ½å¤Ÿæ¥å…¥ Form å¤–ï¼Œå¯¹äºå…¶ä»–çš„ä¸šåŠ¡ä¸­çš„ç‰¹æ®Šéœ€æ±‚éœ€è¦æ¥å…¥ Form çš„æ—¶å€™ï¼Œåªè¦è¿™ä¸ªç»„ä»¶å®ç°äº†ç‰¹å®šçš„æ¥å£å°±å¯ä»¥äº†å¾ˆæ–¹ä¾¿çš„æ¥å…¥ï¼Œè€Œä¸éœ€è¦å¤§é‡çš„å»ä¿®æ”¹ç»„ä»¶å†…éƒ¨çš„ä»£ç ã€‚</p><p>é‡æ„ä¸»è¦é›†ä¸­åœ¨ä¸Šé¢éœ€æ±‚ 1 é‡Œé¢çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ï¼š<strong>è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€</strong></p><p>è·å–å½“å‰è¡¨å•çš„çŠ¶æ€åˆ†è§£ä¸‹æ¥æœ‰ä¸€ä¸‹å‡ ç‚¹ï¼š</p><ul><li>è·å–æ‰€æœ‰éœ€è¦æ”¶é›†çš„å­è¡¨å• <code>formFields</code></li><li>åˆå§‹åŒ– Form <code>state</code></li><li>è¡¨å•ä¸‹é¢å­è¡¨å•æ•°é‡æˆ–ç±»å‹å‘ç”Ÿå˜åŒ–æ—¶æ›´æ–° 1 é‡Œé¢åˆ›å»ºçš„ <code>formFields</code></li><li>å­è¡¨å•å†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶é€šçŸ¥åˆ°çˆ¶è¡¨å•</li></ul><h2 id="è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€-1"><a href="#è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€-1" class="headerlink" title="è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€"></a>è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€</h2><h3 id="è·å–æ‰€æœ‰éœ€è¦çš„å­è¡¨å•"><a href="#è·å–æ‰€æœ‰éœ€è¦çš„å­è¡¨å•" class="headerlink" title="è·å–æ‰€æœ‰éœ€è¦çš„å­è¡¨å•"></a>è·å–æ‰€æœ‰éœ€è¦çš„å­è¡¨å•</h3><p>åŒæ ·é€šè¿‡é€’å½’éå† children æ¥è·å–éœ€è¦æ”¶é›†çš„å­è¡¨å•ï¼Œé€šè¿‡å­è¡¨å•çš„ type.name å‘½åè§„åˆ™æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„å®šä¹‰æ¥å†³å®šæ˜¯å¦è¦è¿›è¡Œæ”¶é›†ã€‚<br>ç›´æ¥æ¥çœ‹ä»£ç ï¼š<br></p><figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line">collectFormField = <span class="function">(<span class="params">children</span>) =></span> {</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> handleFieldChange = <span class="keyword">this</span>.handleFieldChange</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç®€å•ç²—æš´ï¼Œåœ¨ Form æ›´æ–°çš„æ—¶å€™ç›´æ¥æ¸…ç©ºä¸Šä¸€æ¬¡ä¿å­˜çš„ formFieldsï¼Œå…¨é‡æ›´æ–°ï¼Œ</span></span><br><span class="line">  <span class="comment">// é¿å… formFields å†…å®¹æˆ–è€…æ•°é‡å‘ç”Ÿå˜åŒ–æ—¶ this.formFields æ•°æ®ä¸æ­£ç¡®çš„é—®é¢˜</span></span><br><span class="line">  <span class="keyword">const</span> FormFields = <span class="keyword">this</span>.formFields = []</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getChildList</span>(<span class="params">children</span>) </span>{</span><br><span class="line">    <span class="keyword">return</span> React.Children.map(children, (el, i) => {</span><br><span class="line">      <span class="comment">// åªè¦ Name ä»¥ _Field å¼€å¤´ï¼Œå°±è®¤ä¸ºæ˜¯éœ€è¦ From ç®¡ç†çš„ç»„ä»¶</span></span><br><span class="line">      <span class="keyword">if</span> (!el || el === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> reg = <span class="regexp">/^_Field/</span></span><br><span class="line">      <span class="keyword">const</span> childName = el.type && el.type.name</span><br><span class="line">      <span class="keyword">if</span> (reg.test(childName)) {</span><br><span class="line">        FormFields.push(el)</span><br><span class="line">        <span class="keyword">return</span> React.cloneElement(el, {</span><br><span class="line">          key: i,</span><br><span class="line">          handleFieldChange</span><br><span class="line">        })</span><br><span class="line">      } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">if</span> (el.props && el.props.children) {</span><br><span class="line">          <span class="keyword">const</span> children = getChildList(el.props.children)</span><br><span class="line">          <span class="keyword">return</span> React.cloneElement(el, {</span><br><span class="line">            key: i,</span><br><span class="line">            children</span><br><span class="line">          })</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">          <span class="keyword">return</span> el</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    })</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure><p></p><p>åªè¦ç»„ä»¶çš„ class name ä»¥ _Field å¼€å¤´ï¼Œå°±æŠŠå®ƒæ”¶é›†èµ·æ¥ï¼Œå¹¶ä¼ å…¥ <code>handleFieldChange</code> æ–¹æ³•ï¼Œè¿™æ ·å½“ä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶æ¥å…¥çš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨å¤–é¢åŒ…ä¸€å±‚ï¼Œå¹¶æŠŠ class çš„å‘½åä¸ºä»¥ _Field å¼€å¤´çš„æ ¼å¼å°±å¯ä»¥è¢« Form æ”¶é›†ç®¡ç†äº†ã€‚</p><p>æ¥å…¥ç»„ä»¶é‡Œé¢éœ€è¦åšçš„å°±æ˜¯ï¼Œåœ¨åˆé€‚çš„æ—¶æœºè°ƒç”¨ <code>handleFieldChange</code> æ–¹æ³•ï¼Œå¹¶æŠŠè¦ä¼ é€’çš„æ•°æ®ä½œä¸ºå‚æ•°ä¼ é€’å‡ºæ¥å°±å¯ä»¥äº†ã€‚</p><p>ä¸ºä»€ä¹ˆä¸€å®šè¦æ‰§è¿·ä¸æ‚Ÿçš„ä½¿ç”¨éå†è¿™ç§ä½æ•ˆçš„æ–¹å¼å»æ”¶é›†å‘¢ï¼Œå…¶å®éƒ½æ˜¯ä¸ºäº†ç»„ä»¶ä¸Šä½¿ç”¨çš„æ–¹ä¾¿ã€‚è¿™æ ·å°±ä¸éœ€è¦æ¯æ¬¡åœ¨å¼•ç”¨çš„æ—¶å€™åœ¨å¯¹å­è¡¨å•åšä»€ä¹ˆæ“ä½œäº†ã€‚</p><h3 id="åˆå§‹åŒ–-Form-state"><a href="#åˆå§‹åŒ–-Form-state" class="headerlink" title="åˆå§‹åŒ– Form state"></a>åˆå§‹åŒ– Form state</h3><p>ä¸Šä¸€æ­¥æ‹¿åˆ°äº†æ‰€æœ‰çš„å­è¡¨å•ï¼Œç„¶åé€šè¿‡è°ƒç”¨ <code>initialFormDataStructure</code> æ‹¿æ¥åˆå§‹åŒ– Form çš„ <code>state.data</code> çš„ç»“æ„ï¼ŒåŒæ—¶é€šçŸ¥åˆ°å¤–é¢ Form å‘ç”Ÿäº†å˜åŒ–ã€‚</p><h3 id="å­è¡¨å•æ•°é‡æˆ–ç±»å‹å‘ç”Ÿå˜åŒ–æ—¶"><a href="#å­è¡¨å•æ•°é‡æˆ–ç±»å‹å‘ç”Ÿå˜åŒ–æ—¶" class="headerlink" title="å­è¡¨å•æ•°é‡æˆ–ç±»å‹å‘ç”Ÿå˜åŒ–æ—¶"></a>å­è¡¨å•æ•°é‡æˆ–ç±»å‹å‘ç”Ÿå˜åŒ–æ—¶</h3><p>å½“ Form ä¸‹é¢å­ç»„ä»¶è¢«æ·»åŠ æˆ–åˆ é™¤æ—¶ï¼Œéœ€è¦åŠæ—¶æ›´æ–° Form Data çš„ç»“æ„ã€‚é€šè¿‡è°ƒç”¨ <code>updateFormDataStructure</code><br>æŠŠæ–°å¢çš„æˆ–è€…ä¿®æ”¹çš„å­è¡¨å•æ›´æ–°åˆ°æœ€æ–°ï¼Œå¹¶é€šçŸ¥åˆ°å¤–é¢ Form å‘ç”Ÿäº†å˜åŒ–ã€‚</p><h3 id="å­è¡¨å•å†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶"><a href="#å­è¡¨å•å†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶" class="headerlink" title="å­è¡¨å•å†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶"></a>å­è¡¨å•å†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶</h3><p>åœ¨ç¬¬ä¸€æ­¥æ”¶é›†å­è¡¨å•çš„æ—¶å€™å°±å·²ç»æŠŠ <code>handleFieldChange</code> æ³¨å…¥åˆ°äº†å­è¡¨å•ç»„ä»¶é‡Œé¢ï¼Œæ‰€ä»¥å­è¡¨å•æ¥å†³å®šè°ƒç”¨çš„æ—¶æœºã€‚å½“ <code>handleFieldChange</code> è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œé¦–å…ˆå¯¹ Form <code>state</code> è¿›è¡Œæ›´æ–°ï¼Œç„¶åå¤–é€šçŸ¥å­è¡¨å•å‘ç”Ÿäº†å˜åŒ–ï¼ŒåŒæ—¶é€šçŸ¥å¤–é¢ Form å‘ç”Ÿäº†å˜åŒ–ã€‚</p><p>è¿™æ ·çœ‹èµ·æ¥æ•´ä¸ªæµç¨‹å°±èµ°é€šäº†ï¼Œä½†å®é™…ä¸Šå­˜åœ¨å¾ˆå¤šé—®é¢˜ã€‚</p><p>é¦–å…ˆç”±äº <code>setState</code> æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹ï¼Œåªæœ‰åœ¨ <code>render</code> åæ‰èƒ½è·å–åˆ°æœ€æ–°çš„ <code>state</code>. è¿™å°±å¯¼è‡´ï¼Œåœ¨ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå¾ªç¯å†…å¦‚æœæˆ‘å¤šæ¬¡è°ƒç”¨äº† <code>setState</code> ï¼Œé‚£ä¹ˆä¸¤æ¬¡è°ƒç”¨ä¹‹é—´å¯¹ <code>state</code> çš„è¯»å–å¾ˆå¯èƒ½æ˜¯ä¸å‡†ç¡®çš„ã€‚ï¼ˆæœ‰å…³ç”Ÿå‘½å‘¨æœŸçš„è¯¦ç»†å†…å®¹å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="https://www.w3ctech.com/topic/1596ï¼‰" target="_blank" rel="noopener">https://www.w3ctech.com/topic/1596ï¼‰</a></p><p>æ‰€ä»¥æˆ‘åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶å˜é‡ <code>currentState</code> æ¥å­˜æ”¾å½“å‰çŠ¶æ€ä¸‹æœ€æ–°çš„ <code>state</code>ï¼Œæ¯æ¬¡ <code>setState</code> çš„æ—¶å€™éƒ½å¯¹å…¶è¿›è¡Œæ›´æ–°ã€‚</p><p>å¦ä¸€ä¸ªé—®é¢˜æ˜¯å½“ Form å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œ<code>updateFormDataStructure</code> è°ƒç”¨çš„è¿‡äºé¢‘ç¹ã€‚å…¶å®åªæœ‰åœ¨å­è¡¨å•çš„æ•°é‡æˆ–è€…ç±»å‹å‘ç”Ÿå˜åŒ–æ—¶æ‰éœ€è¦æ›´æ–° Form state çš„ç»“æ„ã€‚è€Œç›´æ¥å»å¯¹æ¯”å­è¡¨å•çš„ç±»å‹æ˜¯å¦å‘ç”Ÿå˜åŒ–ä¹Ÿæ˜¯æ„è§å¼€é”€å¾ˆå¤§æ“ä½œï¼Œæ‰€ä»¥é€‰æ‹©å¦ä¸€ç§æŠ˜ä¸­æ–¹å¼ã€‚é€šè¿‡ç»™ Form å½“å‰çš„çŠ¶æ€æ‰“æ ‡ï¼Œå°† Form å¯èƒ½å¤„äºçš„çŠ¶æ€éƒ½æ ‡è¯†å‡ºæ¥ï¼š<br></p><figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">const</span>Â STATUSÂ =Â {</span><br><span class="line">Â Â Init:Â <span class="string">'Init'</span>,</span><br><span class="line">Â Â Normal:Â <span class="string">'Normal'</span>,</span><br><span class="line">Â Â FieldChange:Â <span class="string">'FieldChange'</span>,</span><br><span class="line">Â Â UpdateFormDataStructure:Â <span class="string">'UpdateFormDataStructure'</span>,</span><br><span class="line">Â Â Submit:Â <span class="string">'Submit'</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>è¿™æ ·ï¼Œåªæœ‰åœ¨ Form çš„ <code>STATUS</code> å¤„äº <code>Normal</code> çš„æ—¶å€™æ‰å¯¹å…¶è¿›è¡Œ <code>updateFormDataStructure</code> æ“ä½œã€‚è¿™æ ·å°±å¯ä»¥çœå»å¾ˆå¤šæ¬¡æ¸²æŸ“ä»¥åŠæ— æ•ˆçš„å¯¹å¤–è§¦å‘çš„ <code>FormChange</code> äº‹ä»¶ã€‚</p><p>æäº¤å’Œå¯¹å¤–æš´éœ² Form çŠ¶æ€çš„æ–¹æ³•å’Œä¹‹å‰åŸºæœ¬ä¸€è‡´ï¼Œè¿™æ ·æ•´ä¸ªå¯¹ Form çš„é‡æ„å°±ç®—å®Œæˆäº†ï¼Œå…·ä½“é¡¹ç›®ä¸­ä½¿ç”¨ä½“éªŒè¿˜ä¸é”™ O(âˆ©_âˆ©)O</p><p>Form ç»„ä»¶åœ°å€ï¼š <a href="https://github.com/NE-LOAN-FED/NE-Component/tree/master/src/Form" target="_blank" rel="noopener">https://github.com/NE-LOAN-FED/NE-Component/tree/master/src/Form</a></p><p>æœ€åï¼Œå¦‚æœçœ‹æ–‡ç« çš„ä½ æœ‰ä»€ä¹ˆæ›´å¥½çš„æƒ³æ³•ï¼Œè¯·å‘Šè¯‰æˆ‘ğŸ˜›ã€‚</p></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong> æŠ¹æ¡¥</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://blog.kisnows.com/2017/03/17/react-form-rework-thinking/" title="ä¸€ä¸ª React Form ç»„ä»¶çš„é‡æ„æ€è·¯">https://blog.kisnows.com/2017/03/17/react-form-rework-thinking/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-ND 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/react/" rel="tag"># React</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/01/19/webpack2-migrating-v1-v2/" rel="next" title="ã€ç¿»è¯‘å‘ã€‘Webpack 1 åˆ° 2 å‡çº§æŒ‡å—"><i class="fa fa-chevron-left"></i> ã€ç¿»è¯‘å‘ã€‘Webpack 1 åˆ° 2 å‡çº§æŒ‡å—</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2017/04/20/react-page-render-improve/" rel="prev" title="React å•é¡µé¢åˆå§‹åŒ–æ¸²æŸ“ä¼˜åŒ–">React å•é¡µé¢åˆå§‹åŒ–æ¸²æŸ“ä¼˜åŒ– <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5680248525294797" data-ad-slot="7083418264" data-ad-format="auto"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">ç«™ç‚¹æ¦‚è§ˆ</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/imgs/avatar.jpg" alt="æŠ¹æ¡¥"><p class="site-author-name" itemprop="name">æŠ¹æ¡¥</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">64</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">2</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">39</span> <span class="site-state-item-name">æ ‡ç­¾</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/kisnows" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:yq12315@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://twitter.com/_moqiao" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i>Twitter</a> </span><span class="links-of-author-item"><a href="http://www.weibo.com/q912654" target="_blank" title="Weibo"><i class="fa fa-fw fa-weibo"></i>Weibo</a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" class="cc-opacity" target="_blank"><img src="/images/cc-by-nc-nd.svg" alt="Creative Commons"></a></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Before"><span class="nav-number">1.</span> <span class="nav-text">Before</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€"><span class="nav-number">1.1.</span> <span class="nav-text">è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å¦‚ä½•è·å–å˜åŠ¨çš„å­è¡¨å•"><span class="nav-number">1.1.1.</span> <span class="nav-text">å¦‚ä½•è·å–å˜åŠ¨çš„å­è¡¨å•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ”¶é›†å˜åŠ¨è¡¨å•çš„æ•°æ®ã€‚"><span class="nav-number">1.1.2.</span> <span class="nav-text">æ”¶é›†å˜åŠ¨è¡¨å•çš„æ•°æ®ã€‚</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ ¡éªŒè¡¨å•æ˜¯å¦å¡«å†™å®Œæˆ"><span class="nav-number">1.1.3.</span> <span class="nav-text">æ ¡éªŒè¡¨å•æ˜¯å¦å¡«å†™å®Œæˆ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶æ€çš„æ–¹æ³•"><span class="nav-number">1.2.</span> <span class="nav-text">æš´éœ²å¯¹å¤–æä¾›æ•´ä¸ªè¡¨å•çŠ¶æ€çš„æ–¹æ³•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æäº¤æ–¹æ³•"><span class="nav-number">1.3.</span> <span class="nav-text">æäº¤æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ£€éªŒè¡¨å•æ˜¯å¦é€šè¿‡æ ¡éªŒ"><span class="nav-number">1.3.1.</span> <span class="nav-text">æ£€éªŒè¡¨å•æ˜¯å¦é€šè¿‡æ ¡éªŒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯¹å¤–è§¦å‘-formSubmit-æ–¹æ³•"><span class="nav-number">1.3.2.</span> <span class="nav-text">å¯¹å¤–è§¦å‘ formSubmit æ–¹æ³•</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#After"><span class="nav-number">2.</span> <span class="nav-text">After</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€-1"><span class="nav-number">2.1.</span> <span class="nav-text">è·å–å½“å‰å˜åŠ¨è¡¨å•çš„çŠ¶æ€</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è·å–æ‰€æœ‰éœ€è¦çš„å­è¡¨å•"><span class="nav-number">2.1.1.</span> <span class="nav-text">è·å–æ‰€æœ‰éœ€è¦çš„å­è¡¨å•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆå§‹åŒ–-Form-state"><span class="nav-number">2.1.2.</span> <span class="nav-text">åˆå§‹åŒ– Form state</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å­è¡¨å•æ•°é‡æˆ–ç±»å‹å‘ç”Ÿå˜åŒ–æ—¶"><span class="nav-number">2.1.3.</span> <span class="nav-text">å­è¡¨å•æ•°é‡æˆ–ç±»å‹å‘ç”Ÿå˜åŒ–æ—¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å­è¡¨å•å†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶"><span class="nav-number">2.1.4.</span> <span class="nav-text">å­è¡¨å•å†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶</span></a></li></ol></li></ol></li></ol></div></div></section><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:inline-block;width:200px;height:200px" data-ad-client="ca-pub-5680248525294797" data-ad-slot="4151801469"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">Â© <span itemprop="copyrightYear">2018</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">æŠ¹æ¡¥</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="Site words total count"></span></div><div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div><span class="post-meta-divider">|</span><div class="theme-info">ä¸»é¢˜ â€” <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script id="dsq-count-scr" src="https://kisnowsblog.disqus.com/count.js" async></script><script type="text/javascript">var disqus_config=function(){this.page.url="https://blog.kisnows.com/2017/03/17/react-form-rework-thinking/",this.page.identifier="2017/03/17/react-form-rework-thinking/",this.page.title="ä¸€ä¸ª React Form ç»„ä»¶çš„é‡æ„æ€è·¯"},d=document,s=d.createElement("script");s.src="https://kisnowsblog.disqus.com/embed.js",s.setAttribute("data-timestamp",""+ +new Date),(d.head||d.body).appendChild(s)</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("i94Fztq8fCCVeVdaAsj5QJFA-gzGzoHsz","qaPHXx9ykQRH0XhF1DawhWN1")</script><script>function showTime(e){var t=new AV.Query(e),c=[],u=$(".leancloud_visitors");u.each(function(){c.push($(this).attr("id").trim())}),t.containedIn("url",c),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var n=0;n<e.length;n++){var o=e[n],i=o.get("url"),s=o.get("time"),r=document.getElementById(i);$(r).find(t).text(s)}for(n=0;n<c.length;n++){i=c[n],r=document.getElementById(i);var l=$(r).find(t);""==l.text()&&l.text(0)}}else u.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(i){var e=$(".leancloud_visitors"),s=e.attr("id").trim(),r=e.attr("data-flag-title").trim(),t=new AV.Query(i);t.equalTo("url",s),t.find({success:function(e){if(0<e.length){var t=e[0];t.fetchWhenSave(!0),t.increment("time"),t.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var n=new i,o=new AV.ACL;o.setPublicReadAccess(!0),o.setPublicWriteAccess(!0),n.setACL(o),n.set("title",r),n.set("url",s),n.set("time",1),n.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):1<$(".post-title-link").length&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script></script><script type="text/javascript" src="/js/bundle.js"></script></body></html>